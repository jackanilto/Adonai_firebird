unit UCadMembro;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.DBCtrls, Vcl.Mask,
  Vcl.ComCtrls, Vcl.Buttons, Data.DB, Vcl.Grids, Vcl.DBGrids, Data.Bind.EngExt,
  Vcl.Bind.DBEngExt, System.Rtti, System.Bindings.Outputs, Data.Bind.Components,
  Data.Bind.DBScope, Vcl.ExtCtrls;

type
  TFrmCadMembro = class(TForm)
    PageControl1: TPageControl;
    TabSheet1: TTabSheet;
    TabSheet2: TTabSheet;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    EditID: TEdit;
    EditNOME: TEdit;
    EditENDERECO: TEdit;
    EditNUMERO: TEdit;
    EditBAIRRO: TEdit;
    EditCIDADE: TEdit;
    EditESTADO: TEdit;
    EditCEP: TEdit;
    Label9: TLabel;
    EditCOMPLEMENTO: TEdit;
    Label10: TLabel;
    Label11: TLabel;
    Label12: TLabel;
    Label13: TLabel;
    Label14: TLabel;
    Label15: TLabel;
    Label16: TLabel;
    Label17: TLabel;
    Label18: TLabel;
    Label19: TLabel;
    Label20: TLabel;
    Label21: TLabel;
    EditTELPESSOAL: TEdit;
    EditCONTATO1: TEdit;
    EditCONTATO2: TEdit;
    EditEMAIL: TEdit;
    EditSEXO: TEdit;
    EditESTCIVIL: TEdit;
    EditPROFISSAO: TEdit;
    EditRG: TEdit;
    EditCPF: TEdit;
    EditNOMEPAI: TEdit;
    EditNOMEMAE: TEdit;
    Label22: TLabel;
    EditTITULO_ELEITOR: TEdit;
    Label23: TLabel;
    EditNATURALIDADE: TEdit;
    Label24: TLabel;
    Label25: TLabel;
    Label26: TLabel;
    Label27: TLabel;
    EditDATACASAMENTO: TEdit;
    EditFILHOS: TEdit;
    EditCONJUGE: TEdit;
    EditNASC_CONJUGE: TEdit;
    Label28: TLabel;
    EditESCOLARIDADE: TEdit;
    Label42: TLabel;
    EditATIVO: TEdit;
    Label46: TLabel;
    EditDATA_NASC: TEdit;
    MemoHISTORICO: TMemo;
    Label52: TLabel;
    Edit45: TEdit;
    Label53: TLabel;
    EditCAMPO15: TEdit;
    Label51: TLabel;
    EditTIPOMORADA: TEdit;
    Label50: TLabel;
    EditIGREJABATISMO: TEdit;
    Label43: TLabel;
    EditMINISTERIO: TEdit;
    Label35: TLabel;
    EditDIZIMISTA: TEdit;
    Label29: TLabel;
    Label30: TLabel;
    EditVALOR: TEdit;
    Label36: TLabel;
    EditBATIZADO: TEdit;
    Label44: TLabel;
    EditCIDADEBATISMO: TEdit;
    EditDATACONSAGRACAO: TEdit;
    Label45: TLabel;
    EditDATABATISMO: TEdit;
    Label37: TLabel;
    EditGRUPO: TEdit;
    Label31: TLabel;
    Label32: TLabel;
    EditTRATAMENTO: TEdit;
    Label38: TLabel;
    EditDATAADMISSAO: TEdit;
    EditTAG: TEdit;
    Label47: TLabel;
    EditVALIDADECARTEIRA: TEdit;
    Label39: TLabel;
    EditNASCIMENTO: TEdit;
    Label33: TLabel;
    Label40: TLabel;
    EditPAISORIGEM: TEdit;
    Label48: TLabel;
    EditCAMPO11: TEdit;
    EditCAMPO13: TEdit;
    Label49: TLabel;
    EditTELPAISOIG: TEdit;
    Label41: TLabel;
    EditOBSERVACAO: TEdit;
    Label34: TLabel;
    btnNovo: TSpeedButton;
    btnSalvar: TSpeedButton;
    btnEditar: TSpeedButton;
    btnDeletar: TSpeedButton;
    DBGMEMBRO: TDBGrid;
    img: TImage;
    dialog: TOpenDialog;
    btnAdd: TSpeedButton;
    EditBuscar: TEdit;
    Label54: TLabel;
    procedure btnSalvarClick(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure btnNovoClick(Sender: TObject);
    procedure btnAddClick(Sender: TObject);
    procedure DBGMEMBROCellClick(Column: TColumn);
    procedure btnEditarClick(Sender: TObject);
    procedure EditBuscarChange(Sender: TObject);
  private
    { Private declarations }
    procedure limparCampos();
    procedure habilitarCampos();
    procedure desabilitarCampos();
    procedure buscarTudo();
    procedure buscarNome();
    procedure associarCampos();
    procedure carregarImagemPadrao();
    procedure salvarFoto();
  public
    { Public declarations }
  end;

var
  FrmCadMembro: TFrmCadMembro;
  caminhoImg: string;
  imgMembro: TPicture;
  alterou: boolean;

implementation

{$R *.dfm}

uses UDM, ULogin, UPrincipal;

{ TFrmCadMembro }

procedure TFrmCadMembro.associarCampos;
begin
//DM.TblMembro.FieldByName('ID').Value := EditID.Text;
DM.Tbl_Membro.FieldByName('NOME').Value := EditNOME.Text;
DM.Tbl_Membro.FieldByName('ENDERECO').Value := EditENDERECO.Text;
DM.Tbl_Membro.FieldByName('NUMERO').Value := EditNUMERO.Text;
DM.Tbl_Membro.FieldByName('BAIRRO').Value := EditBAIRRO.Text;
DM.Tbl_Membro.FieldByName('CIDADE').Value := EditCIDADE.Text;
DM.Tbl_Membro.FieldByName('ESTADO').Value := EditESTADO.Text;           // <<<
DM.Tbl_Membro.FieldByName('CEP').Value := EditCEP.Text;
DM.Tbl_Membro.FieldByName('COMPLEMENTO').Value := EditCOMPLEMENTO.Text;
DM.Tbl_Membro.FieldByName('TEL.PESSOAL').Value := EditTELPESSOAL.Text;
DM.Tbl_Membro.FieldByName('CONTATO1').Value := EditCONTATO1.Text;
DM.Tbl_Membro.FieldByName('CONTATO2').Value := EditCONTATO2.Text;
DM.Tbl_Membro.FieldByName('EMAIL').Value := EditEMAIL.Text;
DM.Tbl_Membro.FieldByName('SEXO').Value := EditSEXO.Text;           // <<<
DM.Tbl_Membro.FieldByName('ESTADO_CIVIL').Value := EditESTCIVIL.Text;            // <<<
DM.Tbl_Membro.FieldByName('PROFISSAO').Value := EditPROFISSAO.Text;       // <<<
DM.Tbl_Membro.FieldByName('RG').Value := EditRG.Text;
DM.Tbl_Membro.FieldByName('CPF').Value := EditCPF.Text;
DM.Tbl_Membro.FieldByName('TITULO_ELEITOR').Value := EditTITULO_ELEITOR.Text;
DM.Tbl_Membro.FieldByName('NOME_PAI').Value := EditNOMEPAI.Text;
DM.Tbl_Membro.FieldByName('NOME_MAE').Value := EditNOMEMAE.Text;
DM.Tbl_Membro.FieldByName('TITULO_ELEITOR').Value := EditTITULO_ELEITOR.Text;
DM.Tbl_Membro.FieldByName('NATURALIDADE').Value := EditNATURALIDADE.Text;
DM.Tbl_Membro.FieldByName('DATA_CASAMENTO').Value := EditDATACASAMENTO.Text;
DM.Tbl_Membro.FieldByName('FILHOS').Value := EditFILHOS.Text;
DM.Tbl_Membro.FieldByName('CONJUGE').Value := EditCONJUGE.Text;
DM.Tbl_Membro.FieldByName('NASC_CONJUGE').Value := EditNASC_CONJUGE.Text;
DM.Tbl_Membro.FieldByName('GRAU_ESCOLARIDADE').Value := EditESCOLARIDADE.Text;    // <<<
DM.Tbl_Membro.FieldByName('DIZIMISTA').Value := EditDIZIMISTA.Text;
DM.Tbl_Membro.FieldByName('VALOR').Value := EditVALOR.Text;
DM.Tbl_Membro.FieldByName('GRUPO').Value := EditGRUPO.Text;           // <<<
DM.Tbl_Membro.FieldByName('TRATAMENTO').Value := EditTRATAMENTO.Text;      // <<<
DM.Tbl_Membro.FieldByName('DATA_NASC').Value := EditDATA_NASC.Text;
DM.Tbl_Membro.FieldByName('OBS').Value := EditOBSERVACAO.Text;
DM.Tbl_Membro.FieldByName('MINISTERIO').Value := EditMINISTERIO.Text;      // <<<
DM.Tbl_Membro.FieldByName('BATIZADO').Value := EditBATIZADO.Text;
DM.Tbl_Membro.FieldByName('DATA_BATISMO').Value := EditDATABATISMO.Text;
DM.Tbl_Membro.FieldByName('DATA_ADMISSAO').Value := EditDATAADMISSAO.Text;
DM.Tbl_Membro.FieldByName('VALIDADE_CARTEIRA').Value := EditVALIDADECARTEIRA.Text;
DM.Tbl_Membro.FieldByName('TELEFONE_PAIS_ORIGEM').Value := EditTELPAISOIG.Text;
DM.Tbl_Membro.FieldByName('PAIS_ORIGEM').Value := EditPAISORIGEM.Text;
DM.Tbl_Membro.FieldByName('IGREJA_BATISMO').Value := EditIGREJABATISMO.Text;
DM.Tbl_Membro.FieldByName('CIDADE_BATISMO').Value := EditCIDADEBATISMO.Text;
DM.Tbl_Membro.FieldByName('DATA_CONSAGRACAO').Value := EditDATACONSAGRACAO.Text;
DM.Tbl_Membro.FieldByName('TIPO_MORADIA').Value := EditTIPOMORADA.Text;

end;

procedure TFrmCadMembro.desabilitarCampos;
begin
EditID.Enabled := false;
EditNOME.Enabled := false;
EditENDERECO.Enabled := false;
EditNUMERO.Enabled := false;
EditBAIRRO.Enabled := false;
EditCIDADE.Enabled := false;
EditESTADO.Enabled := false;
EditCEP.Enabled := false;
EditCOMPLEMENTO.Enabled := false;
EditTELPESSOAL.Enabled := false;
EditCONTATO1.Enabled := false;
EditCONTATO2.Enabled := false;
EditEMAIL.Enabled := false;
EditSEXO.Enabled := false;
EditESTCIVIL.Enabled := false;
EditPROFISSAO.Enabled := false;
EditRG.Enabled := false;
EditCPF.Enabled := false;
EditNOMEPAI.Enabled := false;
EditNOMEMAE.Enabled := false;
EditTITULO_ELEITOR.Enabled := false;
EditNATURALIDADE.Enabled := false;
EditDATACASAMENTO.Enabled := false;
EditFILHOS.Enabled := false;
EditCONJUGE.Enabled := false;
EditNASC_CONJUGE.Enabled := false;
EditESCOLARIDADE.Enabled := false;
EditDIZIMISTA.Enabled := false;
EditVALOR.Enabled := false;
EditGRUPO.Enabled := false;
EditTRATAMENTO.Enabled := false;
EditDATA_NASC.Enabled := false;
EditOBSERVACAO.Enabled := false;
EditMINISTERIO.Enabled := false;
EditBATIZADO.Enabled := false;
EditDATABATISMO.Enabled := false;
EditDATAADMISSAO.Enabled := false;
EditVALIDADECARTEIRA.Enabled := false;
EditTELPAISOIG.Enabled := false;
EditPAISORIGEM.Enabled := false;
EditIGREJABATISMO.Enabled := false;
EditCIDADEBATISMO.Enabled := false;
EditDATACONSAGRACAO.Enabled := false;
EditTIPOMORADA.Enabled := false;
end;

procedure TFrmCadMembro.EditBuscarChange(Sender: TObject);
begin
buscarNome;

end;

procedure TFrmCadMembro.FormShow(Sender: TObject);
begin
DM.Tbl_Membro.Active := True; // Habilita tabela para inserção
buscarTudo;

btnSalvar.Enabled := false;
btnEditar.Enabled := false;
btnDeletar.Enabled := false;

carregarImagemPadrao();
end;


procedure ExibeFoto(DataSet : TDataSet; BlobFieldName : String; ImageExibicao :
TImage);

 var MemoryStream:TMemoryStream; jpg : TPicture;
 const
  OffsetMemoryStream : Int64 = 0;

begin
  if not(DataSet.IsEmpty) and
  not((DataSet.FieldByName(BlobFieldName) as TBlobField).IsNull) then
    try
      MemoryStream := TMemoryStream.Create;
      Jpg := TPicture.Create;
      (DataSet.FieldByName(BlobFieldName) as
TBlobField).SaveToStream(MemoryStream);
      MemoryStream.Position := OffsetMemoryStream;
      Jpg.LoadFromStream(MemoryStream);
      ImageExibicao.Picture.Assign(Jpg);
    finally
     // Jpg.Free;
      MemoryStream.Free;
    end
  else
    ImageExibicao.Picture := Nil;
end;



procedure TFrmCadMembro.habilitarCampos;
begin
EditID.Enabled := true;
EditNOME.Enabled := true;
EditENDERECO.Enabled := true;
EditNUMERO.Enabled := true;
EditBAIRRO.Enabled := true;
EditCIDADE.Enabled := true;
EditESTADO.Enabled := true;
EditCEP.Enabled := true;
EditCOMPLEMENTO.Enabled := true;
EditTELPESSOAL.Enabled := true;
EditCONTATO1.Enabled := true;
EditCONTATO2.Enabled := true;
EditEMAIL.Enabled := true;
EditSEXO.Enabled := true;
EditESTCIVIL.Enabled := true;
EditPROFISSAO.Enabled := true;
EditRG.Enabled := true;
EditCPF.Enabled := true;
EditNOMEPAI.Enabled := true;
EditNOMEMAE.Enabled := true;
EditTITULO_ELEITOR.Enabled := true;
EditNATURALIDADE.Enabled := true;
EditDATACASAMENTO.Enabled := true;
EditFILHOS.Enabled := true;
EditCONJUGE.Enabled := true;
EditNASC_CONJUGE.Enabled := true;
EditESCOLARIDADE.Enabled := true;
EditDIZIMISTA.Enabled := true;
EditVALOR.Enabled := true;
EditGRUPO.Enabled := true;
EditTRATAMENTO.Enabled := true;
EditDATA_NASC.Enabled := true;
EditOBSERVACAO.Enabled := true;
EditMINISTERIO.Enabled := true;
EditBATIZADO.Enabled := true;
EditDATABATISMO.Enabled := true;
EditDATAADMISSAO.Enabled := true;
EditVALIDADECARTEIRA.Enabled := true;
EditTELPAISOIG.Enabled := true;
EditPAISORIGEM.Enabled := true;
EditIGREJABATISMO.Enabled := true;
EditCIDADEBATISMO.Enabled := true;
EditDATACONSAGRACAO.Enabled := true;
EditTIPOMORADA.Enabled := true;
EditNOME.SetFocus; // Coloca o foco no edit nome Obs: o SetFocus precisa ser depois de habilitado o campo
// se adicionar antes vai dar erro devido ao delphi seguir linha a linha os paramentros

end;

procedure TFrmCadMembro.limparCampos;
begin
EditID.Text := '';
EditNOME.Text := '';
EditENDERECO.Text := '';
EditNUMERO.Text := '';
EditBAIRRO.Text := '';
EditCIDADE.Text := '';
EditESTADO.Text := '';
EditCEP.Text := '';
EditCOMPLEMENTO.Text := '';
EditTELPESSOAL.Text := '';
EditCONTATO1.Text := '';
EditCONTATO2.Text :='';
EditEMAIL.Text := '';
EditSEXO.Text := '';
EditESTCIVIL.Text := '';
EditPROFISSAO.Text := '';
EditRG.Text := '';
EditCPF.Text := '';
EditNOMEPAI.Text := '';
EditNOMEMAE.Text := '';
EditTITULO_ELEITOR.Text := '';
EditNATURALIDADE.Text := '';
EditDATACASAMENTO.Text := '';
EditFILHOS.Text := '';
EditCONJUGE.Text := '';
EditNASC_CONJUGE.Text := '';
EditESCOLARIDADE.Text := '';
EditDIZIMISTA.Text := '';
EditVALOR.Text := '';
EditGRUPO.Text := '';
EditTRATAMENTO.Text := '';
EditDATA_NASC.Text := '';
EditOBSERVACAO.Text := '';
EditMINISTERIO.Text := '';
EditBATIZADO.Text := '';
EditDATABATISMO.Text := '';
EditDATAADMISSAO.Text := '';
EditVALIDADECARTEIRA.Text := '';
EditTELPAISOIG.Text := '';
EditPAISORIGEM.Text := '';
EditIGREJABATISMO.Text := '';
EditCIDADEBATISMO.Text := '';
EditDATACONSAGRACAO.Text := '';
EditTIPOMORADA.Text := '';
carregarImagemPadrao();

end;

procedure TFrmCadMembro.salvarFoto;
begin
 if dialog.FileName <> '' then
  begin
  imgMembro := TPicture.Create;
  imgMembro.LoadFromFile(dialog.FileName);
  DM.Tbl_Membro.FieldByName('imagem').Assign(imgMembro);
  imgMembro.Free;
  dialog.FileName := GetCurrentDir + '\img\sem-foto.jpg';
  alterou := false;
  end
  else
    begin
  dm.Tbl_Membro.FieldByName('imagem').Value := GetCurrentDir + '\img\sem-foto.jpg';

  end;
end;

procedure TFrmCadMembro.btnAddClick(Sender: TObject);
begin
dialog.Execute();
img.Picture.LoadFromFile(dialog.filename);
alterou := true;  //Verifica se a imagem foi alterada
end;

procedure TFrmCadMembro.btnEditarClick(Sender: TObject);
begin
//if (editNome.Text <> '') then
//    begin
//    associarCampos;
//    dm.TBL_MEMBRO.Edit;
//
//    DM.QueyMembro.Close;
//    dm.QueyMembro.SQL.Clear;
//
//    if alterou = false then
//    begin
//    dm.QueyMembro.SQL.Add('update TBL_MEMBRO set nome = :nome, endereco = :endereco, numero := numero, bairro := bairro, cidade := cidade, estado := estado, cep := cep, complemento := complemento'+
//    'tel.pessoal := tel.pessoal, contato1 := contato1, contato2 := contato2, email := email, dizimista := dizimista, valor := valor, grupo := grupo, tratamento := tratamento'+
//    'imagem := imagem, sexo := sexo, estado_civil := estado_civil, ministerio := ministerio, profissao := profissao, grau_escolaridade := grau_escolaridade, batizado := batizado'+
//    'rg := rg, cpf := cpf, nome_pai := nome_pai, nome_mae := nome_mae, data_batismo := data_batismo, data_admissao := data_admissao, pais_origem := pais_origem, telefone_pais_origem := telfone_pais_origem'+
//    'data_casamento := data_casamento, ativo := ativo, igreja_batismo := igreja_batismo, data_consagracao := data_consagracao, naturalidade := natualidade, titulo_eleitor := titulo_eleitor'+
//    'filhos := filhos, validade_carteira := validade_carteira, tag := tag, conjuge := conjuge, tipo_moradia := tipo_moradia, historico := historico, profissao := pofissao, nasc_conjuge := nasc_conjuge'+
//    'cidade_bastismo := cidade_batismo, data_nasc := data_nasc, campo13 := campo13, campo15 := campo15, observacao := observacao where id = :id');
//    end
//    else
//    begin
//    dm.QueyMembro.SQL.Add('update TBL_MEMBRO set nome = :nome, endereco = :endereco, numero := numero, bairro := bairro, cidade := cidade, estado := estado, cep := cep, complemento := complemento'+
//    'tel.pessoal := tel.pessoal, contato1 := contato1, contato2 := contato2, email := email, dizimista := dizimista, valor := valor, grupo := grupo, tratamento := tratamento'+
//    'imagem := imagem, sexo := sexo, estado_civil := estado_civil, ministerio := ministerio, profissao := profissao, grau_escolaridade := grau_escolaridade, batizado := batizado'+
//    'rg := rg, cpf := cpf, nome_pai := nome_pai, nome_mae := nome_mae, data_batismo := data_batismo, data_admissao := data_admissao, pais_origem := pais_origem, telefone_pais_origem := telfone_pais_origem'+
//    'data_casamento := data_casamento, ativo := ativo, igreja_batismo := igreja_batismo, data_consagracao := data_consagracao, naturalidade := natualidade, titulo_eleitor := titulo_eleitor'+
//    'filhos := filhos, validade_carteira := validade_carteira, tag := tag, conjuge := conjuge, tipo_moradia := tipo_moradia, historico := historico, profissao := pofissao, nasc_conjuge := nasc_conjuge'+
//    'cidade_bastismo := cidade_batismo, data_nasc := data_nasc, campo13 := campo13, campo15 := campo15, observacao := observacao, imagem = :imagem  where id = :id');
//    img := TPicture.Create;
//    img.LoadFromFile(dialog.FileName);
//    dm.QueyMembro.ParamByName('imagem').Assign(img);
//    img.Free;
//    alterou := false;
//    end;
//
//dm.QueyMembro.ParamByName('NOME').Value := EditNOME.Text;
//dm.QueyMembro.ParamByName('ENDERECO').Value := EditENDERECO.Text;
//dm.QueyMembro.ParamByName('NUMERO').Value := EditNUMERO.Text;
//dm.QueyMembro.ParamByName('BAIRRO').Value := EditBAIRRO.Text;
//dm.QueyMembro.ParamByName('CIDADE').Value := EditCIDADE.Text;
//dm.QueyMembro.ParamByName('ESTADO').Value := EditESTADO.Text;
//dm.QueyMembro.ParamByName('CEP').Value := EditCEP.Text;
//dm.QueyMembro.ParamByName('COMPLEMENTO').Value := EditCOMPLEMENTO.Text;
//dm.QueyMembro.ParamByName('TEL.PESSOAL').Value := EditTELPESSOAL.Text;
//dm.QueyMembro.ParamByName('CONTATO1').Value := EditCONTATO1.Text;
//dm.QueyMembro.ParamByName('CONTATO2').Value := EditCONTATO2.Text;
//dm.QueyMembro.ParamByName('EMAIL').Value := EditEMAIL.Text;
//dm.QueyMembro.ParamByName('SEXO').Value := EditSEXO.Text;
//dm.QueyMembro.ParamByName('ESTADO_CIVIL').Value := EditESTCIVIL.Text;
//dm.QueyMembro.ParamByName('PROFISSAO').Value := EditPROFISSAO.Text;
//dm.QueyMembro.ParamByName('RG').Value := EditRG.Text;
//dm.QueyMembro.ParamByName('CPF').Value := EditCPF.Text;
//dm.QueyMembro.ParamByName('TITULO_ELEITOR').Value := EditTITULO_ELEITOR.Text;
//dm.QueyMembro.ParamByName('NOME_PAI').Value := EditNOMEPAI.Text;
//dm.QueyMembro.ParamByName('NOME_MAE').Value := EditNOMEMAE.Text;
//dm.QueyMembro.ParamByName('TITULO_ELEITOR').Value := EditTITULO_ELEITOR.Text;
//dm.QueyMembro.ParamByName('NATURALIDADE').Value := EditNATURALIDADE.Text;
//dm.QueyMembro.ParamByName('DATA_CASAMENTO').Value := EditDATACASAMENTO.Text;
//dm.QueyMembro.ParamByName('FILHOS').Value := EditFILHOS.Text;
//dm.QueyMembro.ParamByName('CONJUGE').Value := EditCONJUGE.Text;
//dm.QueyMembro.ParamByName('NASC_CONJUGE').Value := EditNASC_CONJUGE.Text;
//dm.QueyMembro.ParamByName('GRAU_ESCOLARIDADE').Value := EditESCOLARIDADE.Text;
//dm.QueyMembro.ParamByName('DIZIMISTA').Value := EditDIZIMISTA.Text;
//dm.QueyMembro.ParamByName('VALOR').Value := EditVALOR.Text;
//dm.QueyMembro.ParamByName('GRUPO').Value := EditGRUPO.Text;
//dm.QueyMembro.ParamByName('TRATAMENTO').Value := EditTRATAMENTO.Text;
//dm.QueyMembro.ParamByName('DATA_NASC').Value := EditDATA_NASC.Text;
//dm.QueyMembro.ParamByName('OBS').Value := EditOBSERVACAO.Text;
//dm.QueyMembro.ParamByName('MINISTERIO').Value := EditMINISTERIO.Text;
//dm.QueyMembro.ParamByName('BATIZADO').Value := EditBATIZADO.Text;
//dm.QueyMembro.ParamByName('DATA_BATISMO').Value := EditDATABATISMO.Text;
//dm.QueyMembro.ParamByName('DATA_ADMISSAO').Value := EditDATAADMISSAO.Text;
//dm.QueyMembro.ParamByName('VALIDADE_CARTEIRA').Value := EditVALIDADECARTEIRA.Text;
//dm.QueyMembro.ParamByName('TELEFONE_PAIS_ORIGEM').Value := EditTELPAISOIG.Text;
//dm.QueyMembro.ParamByName('PAIS_ORIGEM').Value := EditPAISORIGEM.Text;
//dm.QueyMembro.ParamByName('IGREJA_BATISMO').Value := EditIGREJABATISMO.Text;
//dm.QueyMembro.ParamByName('CIDADE_BATISMO').Value := EditCIDADEBATISMO.Text;
//dm.QueyMembro.ParamByName('DATA_CONSAGRACAO').Value := EditDATACONSAGRACAO.Text;
//dm.QueyMembro.ParamByName('TIPO_MORADIA').Value := EditTIPOMORADA.Text;
//
//dm.QueyMembro.ParamByName('id').Value := editID.Text;
//dm.QueyMembro.ExecSql;
//
//    MessageDlg('Editado com Sucesso!!', mtInformation, mbOKCancel, 0);
//    buscarTudo;
//    desabilitarCampos;
//    limparCampos;
//    btnSalvar.Enabled := false;
//    btnEditar.Enabled := false;
//    btnDeletar.Enabled := false;
//    btnNovo.Enabled := true;
//    end
//    else
//    begin
//    MessageDlg('Preencha os Campos', mtInformation, mbOKCancel, 0);
//    end;
end;


procedure TFrmCadMembro.btnNovoClick(Sender: TObject);
begin
limparCampos;
habilitarCampos;
EditNOME.SetFocus;    //Coloca o foco no EditNome após Habilita campos
DM.Tbl_Membro.Insert;
BtnSalvar.Enabled := true;
BtnAdd.Enabled := true;
btnNovo.Enabled := false;
btnEditar.Enabled := false;
btnDeletar.Enabled := false;
DBGMEMBRO.Enabled := false;
end;

procedure TFrmCadMembro.btnSalvarClick(Sender: TObject);
begin
if (EditNOME.Text <> '') then
  begin
  associarCampos;
  salvarFoto;
  DM.Tbl_Membro.Post;
  MessageDlg('Salvo com Sucesso!!', mtInformation, mbOKCancel, 0);
  buscarTudo;
  limparCampos;
  desabilitarCampos;
  btnSalvar.Enabled := false;
  btnNovo.Enabled := true;
  btnEditar.Enabled := false;
  btnDeletar.Enabled := false;
  DBGMEMBRO.Enabled := true;
  end
  else
  begin
  MessageDlg('Preencha os Campos', mtInformation, mbOKCancel, 0);
  end;
end;

procedure TFrmCadMembro.buscarNome;
begin
dm.QueyMembro.Close;
dm.QueyMembro.SQL.Clear;
dm.QueyMembro.SQL.Add('select * from tbl_membros where nome LIKE :nome order by nome asc');
dm.QueyMembro.ParamByName('nome').Value := EditBuscar.Text + '%';
dm.QueyMembro.Open;
end;

procedure TFrmCadMembro.buscarTudo;
begin
DM.QueyMembro.Close;
DM.QueyMembro.SQL.Clear;
DM.QueyMembro.SQL.Add('select * from tbl_membros order by nome asc');
DM.QueyMembro.Open;
end;


procedure TFrmCadMembro.carregarImagemPadrao;
begin
    caminhoImg  := GetCurrentDir + '\img\sem-foto.jpg';
    img.Picture.LoadFromFile(caminhoImg);
end;


procedure TFrmCadMembro.DBGMEMBROCellClick(Column: TColumn);
begin
DM.TBL_MEMBRO.Edit;
btnEditar.Enabled := true;
btnDeletar.Enabled := true;
btnAdd.Enabled := true;
habilitarCampos;

if dm.QueyMembro.FieldByName('id').Value <> null then
editID.Text := dm.QueyMembro.FieldByName('id').Value;

if dm.QueyMembro.FieldByName('nome').Value <> null then
EditNOME.Text := dm.QueyMembro.FieldByName('nome').Value;

 if dm.QueyMembro.FieldByName('endereco').Value <> null then
EditENDERECO.Text := dm.QueyMembro.FieldByName('endereco').Value;

 if dm.QueyMembro.FieldByName('bairro').Value <> null then
EditBAIRRO.Text := dm.QueyMembro.FieldByName('bairro').Value;

 if dm.QueyMembro.FieldByName('cidade').Value <> null then
EditCIDADE.Text := dm.QueyMembro.FieldByName('cidade').Value;

 if dm.QueyMembro.FieldByName('estado').Value <> null then
EditESTADO.Text := dm.QueyMembro.FieldByName('estado').Value;

 if dm.QueyMembro.FieldByName('cep').Value <> null then
EditCEP.Text := dm.QueyMembro.FieldByName('cep').Value;

 if dm.QueyMembro.FieldByName('complemento').Value <> null then
EditCOMPLEMENTO.Text := dm.QueyMembro.FieldByName('complemento').Value;

if dm.QueyMembro.FieldByName('tel.pessoal').Value <> null then
EditTELPESSOAL.Text := dm.QueyMembro.FieldByName('tel.pessoal').Value;

 if dm.QueyMembro.FieldByName('contato1').Value <> null then
EditCONTATO1.Text := dm.QueyMembro.FieldByName('contato1').Value;

 if dm.QueyMembro.FieldByName('contato2').Value <> null then
EditCONTATO2.Text := dm.QueyMembro.FieldByName('contato2').Value;

 if dm.QueyMembro.FieldByName('email').Value <> null then
EditEMAIL.Text := dm.QueyMembro.FieldByName('email').Value;

 if dm.QueyMembro.FieldByName('dizimista').Value <> null then
EditDIZIMISTA.Text := dm.QueyMembro.FieldByName('dizimista').Value;

 if dm.QueyMembro.FieldByName('valor').Value <> null then
EditVALOR.Text := dm.QueyMembro.FieldByName('valor').Value;

 if dm.QueyMembro.FieldByName('grupo').Value <> null then
EditGRUPO.Text := dm.QueyMembro.FieldByName('grupo').Value;

 if dm.QueyMembro.FieldByName('tratamento').Value <> null then
EditTRATAMENTO.Text := dm.QueyMembro.FieldByName('tratamento').Value;

 if dm.QueyMembro.FieldByName('observacao').Value <> null then
EditOBSERVACAO.Text := dm.QueyMembro.FieldByName('observacao').Value;

 if dm.QueyMembro.FieldByName('sexo').Value <> null then
EditSEXO.Text := dm.QueyMembro.FieldByName('sexo').Value;

 if dm.QueyMembro.FieldByName('estado_civil').Value <> null then
EditESTCIVIL.Text := dm.QueyMembro.FieldByName('estado_civil').Value;

 if dm.QueyMembro.FieldByName('ministerio').Value <> null then
EditMINISTERIO.Text := dm.QueyMembro.FieldByName('ministerio').Value;

 if dm.QueyMembro.FieldByName('profissao').Value <> null then
EditPROFISSAO.Text := dm.QueyMembro.FieldByName('profissao').Value;

 if dm.QueyMembro.FieldByName('grau_escolaridade').Value <> null then
EditESCOLARIDADE.Text := dm.QueyMembro.FieldByName('grau_escolaridade').Value;

 if dm.QueyMembro.FieldByName('batizado').Value <> null then
EditBATIZADO.Text := dm.QueyMembro.FieldByName('batizado').Value;

 if dm.QueyMembro.FieldByName('rg').Value <> null then
EditRG.Text := dm.QueyMembro.FieldByName('rg').Value;

 if dm.QueyMembro.FieldByName('cpf').Value <> null then
EditCPF.Text := dm.QueyMembro.FieldByName('cpf').Value;

 if dm.QueyMembro.FieldByName('nome_pai').Value <> null then
EditNOMEPAI.Text := dm.QueyMembro.FieldByName('nome_pai').Value;

 if dm.QueyMembro.FieldByName('nome_mae').Value <> null then
EditNOMEMAE.Text := dm.QueyMembro.FieldByName('nome_mae').Value;

 if dm.QueyMembro.FieldByName('data_batismo').Value <> null then
EditDATABATISMO.Text := dm.QueyMembro.FieldByName('data_batismo').Value;

 if dm.QueyMembro.FieldByName('data_admissao').Value <> null then
EditDATAADMISSAO.Text := dm.QueyMembro.FieldByName('data_admissao').Value;

 if dm.QueyMembro.FieldByName('validade_carteira').Value <> null then
EditVALIDADECARTEIRA.Text := dm.QueyMembro.FieldByName('validade_carteira').Value;

 if dm.QueyMembro.FieldByName('pais_origem').Value <> null then
EditPAISORIGEM.Text := dm.QueyMembro.FieldByName('pais_origem').Value;

 if dm.QueyMembro.FieldByName('telefone_pais_origem').Value <> null then
EditTELPAISOIG.Text := dm.QueyMembro.FieldByName('telefone_pais_origem').Value;

 if dm.QueyMembro.FieldByName('data_casamento').Value <> null then
editEndereco.Text := dm.QueyMembro.FieldByName('data_casamento').Value;

 if dm.QueyMembro.FieldByName('ativo').Value <> null then
EditATIVO.Text := dm.QueyMembro.FieldByName('ativo').Value;

 if dm.QueyMembro.FieldByName('igreja_batismo').Value <> null then
EditIGREJABATISMO.Text := dm.QueyMembro.FieldByName('igreja_batismo').Value;

 if dm.QueyMembro.FieldByName('data_consagracao').Value <> null then
EditDATACONSAGRACAO.Text := dm.QueyMembro.FieldByName('data_cosangracao').Value;

 if dm.QueyMembro.FieldByName('naturalidade').Value <> null then
EditNATURALIDADE.Text := dm.QueyMembro.FieldByName('naturalidade').Value;

 if dm.QueyMembro.FieldByName('titulo_eleitor').Value <> null then
EditTITULO_ELEITOR.Text := dm.QueyMembro.FieldByName('titulo_eleitor').Value;

 if dm.QueyMembro.FieldByName('filhos').Value <> null then
EditFILHOS.Text := dm.QueyMembro.FieldByName('filhos').Value;

 if dm.QueyMembro.FieldByName('tag').Value <> null then
EditTAG.Text := dm.QueyMembro.FieldByName('tag').Value;

 if dm.QueyMembro.FieldByName('conjuge').Value <> null then
EditCONJUGE.Text := dm.QueyMembro.FieldByName('conjuge').Value;

 if dm.QueyMembro.FieldByName('cidade_batismo').Value <> null then
EditCIDADEBATISMO.Text := dm.QueyMembro.FieldByName('cidade_batismo').Value;

 if dm.QueyMembro.FieldByName('campo13').Value <> null then
EditCAMPO13.Text := dm.QueyMembro.FieldByName('campo13').Value;

 if dm.QueyMembro.FieldByName('tipo_moradia').Value <> null then
EditTIPOMORADA.Text := dm.QueyMembro.FieldByName('tipo_moradia').Value;

 if dm.QueyMembro.FieldByName('campo15').Value <> null then
EditCAMPO15.Text := dm.QueyMembro.FieldByName('campo15').Value;

 if dm.QueyMembro.FieldByName('historico').Value <> null then
MemoHISTORICO.Text := dm.QueyMembro.FieldByName('historico').Value;

 if dm.QueyMembro.FieldByName('profissao').Value <> null then
EditPROFISSAO.Text := dm.QueyMembro.FieldByName('profissao').Value;

 if dm.QueyMembro.FieldByName('nasc_conjuge').Value <> null then
EditNASC_CONJUGE.Text := dm.QueyMembro.FieldByName('nasc_conjuge').Value;

 if dm.QueyMembro.FieldByName('data_nasc').Value <> null then
EditDATA_NASC.Text := dm.QueyMembro.FieldByName('data_nasc').Value;

 if dm.QueyMembro.FieldByName('observacao').Value <> null then
editobservacao.Text := dm.QueyMembro.FieldByName('observacao').Value;

 if dm.QueyMembro.FieldByName('imagem').Value <> null then
 //img.Picture.LoadFromFile('DM.TBL_MEMBROIMAGEM.Value');
ExibeFoto(dm.QueyMembro, 'imagem', img);

end;


end.
